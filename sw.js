const CACHE_NAME="cerita-di-sekitarmu-v9",STATIC_ASSETS=["/po1/","/po1/index.html","/po1/app.css","/po1/app.bundle.js","/po1/vendors.bundle.js","/po1/app.webmanifest","/po1/favicon.png","/po1/icons/icon-72x72.png","/po1/icons/icon-96x96.png","/po1/icons/icon-128x128.png","/po1/icons/icon-144x144.png","/po1/icons/icon-152x152.png","/po1/icons/icon-192x192.png","/po1/icons/icon-384x384.png","/po1/icons/icon-512x512.png","/po1/images/logo.png","/po1/images/mark.png","/po1/leaflet-images/layers-2x.png","/po1/leaflet-images/layers.png","/po1/leaflet-images/marker-icon-2x.png","/po1/leaflet-images/marker-icon.png","/po1/leaflet-images/marker-shadow.png"];async function cacheFirstStrategy(e){try{const t=await caches.match(e);if(t)return t;const n=await fetch(e);if(n.ok){(await caches.open(CACHE_NAME)).put(e,n.clone())}return n}catch(t){if("document"===e.destination){const e=await caches.match("/po1/index.html");if(e)return e}return new Response("Network error",{status:408,headers:{"Content-Type":"text/plain"}})}}async function networkFirstStrategy(e){try{const t=await fetch(e);if(t.ok&&e.url.includes("/api/")){(await caches.open(CACHE_NAME)).put(e,t.clone())}return t}catch(t){const n=await caches.match(e);return n||(e.url.includes("/api/")?new Response(JSON.stringify({error:!0,message:"You are offline"}),{status:408,headers:{"Content-Type":"application/json"}}):new Response("Offline",{status:408,headers:{"Content-Type":"text/plain"}}))}}self.addEventListener("install",(e=>{e.waitUntil(caches.open(CACHE_NAME).then((e=>e.addAll(STATIC_ASSETS).catch((e=>{})))).then((()=>self.skipWaiting())))})),self.addEventListener("activate",(e=>{e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME)return caches.delete(e)}))))).then((()=>self.clients.claim())))})),self.addEventListener("fetch",(e=>{const t=new URL(e.request.url);"GET"===e.request.method&&t.origin.startsWith(self.location.origin)&&(t.hash&&""!==t.hash||(t.pathname.includes("/api/")||t.href.includes("story-api.dicoding.dev")||"document"===e.request.destination||e.request.headers.get("Accept")?.includes("text/html")?e.respondWith(networkFirstStrategy(e.request)):e.respondWith(cacheFirstStrategy(e.request))))})),self.addEventListener("push",(e=>{e.waitUntil(self.registration.showNotification("Cerita di Sekitarmu",{body:"Ada cerita baru di sekitarmu!",icon:"/po1/icons/icon-192x192.png",badge:"/po1/icons/icon-72x72.png",data:{url:"/po1/"}}))})),self.addEventListener("notificationclick",(e=>{e.notification.close(),e.waitUntil(clients.matchAll({type:"window"}).then((e=>{for(const t of e)if(t.url.includes("/po1/")&&"focus"in t)return t.focus();if(clients.openWindow)return clients.openWindow("/po1/")})))}));