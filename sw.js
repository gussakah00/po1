const CACHE_NAME="cerita-app-v2",STATIC_ASSETS=["/po1/","/po1/index.html"];self.addEventListener("install",(e=>{e.waitUntil(caches.open(CACHE_NAME).then((e=>e.add("/po1/index.html").then((()=>{})).catch((e=>Promise.resolve())))).then((()=>self.skipWaiting())).catch((e=>self.skipWaiting())))})),self.addEventListener("activate",(e=>{e.waitUntil(Promise.all([caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME)return caches.delete(e)}))))),self.clients.claim()]).then((()=>{})).catch((e=>self.clients.claim())))})),self.addEventListener("fetch",(e=>{if("GET"!==e.request.method)return;const t=new URL(e.request.url);t.origin.startsWith(self.location.origin)&&(t.pathname.includes("/api/")||t.href.includes("story-api.dicoding.dev")||("navigate"!==e.request.mode?e.respondWith(fetch(e.request).then((t=>{if(200===t.status){const n=t.clone();caches.open(CACHE_NAME).then((t=>{t.put(e.request,n).then((()=>{})).catch((e=>{}))})).catch((e=>{}))}return t})).catch((t=>caches.match(e.request).then((e=>e||new Response("Resource not available",{status:408,headers:{"Content-Type":"text/plain"}})))))):e.respondWith(caches.match("/po1/index.html").then((t=>t||fetch(e.request))).catch((e=>new Response("\n            <!DOCTYPE html>\n            <html>\n              <head>\n                <title>Offline - Cerita di Sekitarmu</title>\n                <style>\n                  body { font-family: Arial, sans-serif; padding: 20px; text-align: center; }\n                  h1 { color: #4f46e5; }\n                </style>\n              </head>\n              <body>\n                <h1>ğŸ“± Cerita di Sekitarmu</h1>\n                <p>Anda sedang offline. Aplikasi akan tersedia ketika koneksi internet kembali.</p>\n              </body>\n            </html>\n          ",{status:200,headers:{"Content-Type":"text/html"}}))))))})),self.addEventListener("push",(e=>{e.waitUntil(self.registration.showNotification("Cerita di Sekitarmu",{body:"Ada cerita baru di sekitarmu! ğŸ“–",icon:"/po1/icons/icon-192x192.png",badge:"/po1/icons/icon-72x72.png",tag:"story-notification"}).then((()=>{})).catch((e=>{})))})),self.addEventListener("notificationclick",(e=>{e.notification.close(),e.waitUntil(clients.matchAll({type:"window"}).then((e=>{for(const t of e)if(t.url.includes("/po1/")&&"focus"in t)return t.focus();if(clients.openWindow)return clients.openWindow("/po1/")})).catch((e=>{})))})),self.addEventListener("message",(e=>{e.data&&"SKIP_WAITING"===e.data.type&&self.skipWaiting()})),self.addEventListener("error",(e=>{})),self.addEventListener("unhandledrejection",(e=>{}));