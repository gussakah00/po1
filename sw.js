const CACHE_NAME="cerita-app-final";self.addEventListener("install",(e=>{e.waitUntil(self.skipWaiting())})),self.addEventListener("activate",(e=>{e.waitUntil(self.clients.claim())})),self.addEventListener("fetch",(e=>{if("GET"!==e.request.method)return;const t=new URL(e.request.url);t.origin.startsWith(self.location.origin)&&(t.pathname.includes("/api/")||t.href.includes("story-api.dicoding.dev")||("navigate"!==e.request.mode?e.respondWith(fetch(e.request).catch((()=>caches.match(e.request)))):e.respondWith(fetch(e.request).catch((()=>caches.match("/po1/index.html"))))))})),self.addEventListener("push",(e=>{const t={body:"Ada cerita baru di sekitarmu! ðŸ“–",icon:"/po1/icons/icon-192x192.png",badge:"/po1/icons/icon-72x72.png",tag:"new-story",requireInteraction:!1,data:{url:"/po1/",timestamp:(new Date).toISOString()}};e.waitUntil(self.registration.showNotification("Cerita di Sekitarmu",t))})),self.addEventListener("notificationclick",(e=>{e.notification.close();const t=new URL("/po1/",self.location.origin).href,i=clients.matchAll({type:"window",includeUncontrolled:!0}).then((e=>{let i=null;for(let t=0;t<e.length;t++){const n=e[t];if(n.url.includes("/po1/")){i=n;break}}return i?i.focus():clients.openWindow(t)})).catch((e=>clients.openWindow(t)));e.waitUntil(i)}));